### ===========================================
### MÓDULO DE USUÁRIO (USER)
### ===========================================
### Base URL: http://localhost:3000/api/user
### Rotas autenticadas requerem JWT
### ===========================================

### Variáveis de ambiente
@baseUrl = http://localhost:3000/api
@userUrl = {{baseUrl}}/user
@usersUrl = {{baseUrl}}/users
@contentType = application/json

### ===========================================
### AUTENTICAÇÃO - Execute primeiro para obter o token
### ===========================================

# @name login
POST {{baseUrl}}/auth/signin
Content-Type: {{contentType}}

{
  "email": "pessoafisica@exemplo.com",
  "password": "Senha123"
}

### Token salvo automaticamente da resposta do login
@token = {{login.response.body.access_token}}

### ===========================================
### BUSCAR USUÁRIO
### ===========================================

### Buscar dados do usuário autenticado
### GET /api/user
### Retorna: { id: number, email: string }
### Requer: Token JWT
GET {{userUrl}}
Authorization: Bearer {{token}}

### ===========================================
### ATUALIZAR USUÁRIO
### ===========================================

### Atualizar email do usuário
### PATCH /api/user/:id
### Body: { email?: string, password?: string }
### Requer: Token JWT
### Validações:
###   - email: formato válido de email
###   - password: mínimo 6 caracteres
PATCH {{userUrl}}/1
Authorization: Bearer {{token}}
Content-Type: {{contentType}}

{
  "email": "novo.email@email.com"
}

### Atualizar senha do usuário
PATCH {{userUrl}}/1
Authorization: Bearer {{token}}
Content-Type: {{contentType}}

{
  "password": "NovaSenha123"
}

### Atualizar email e senha do usuário
PATCH {{userUrl}}/1
Authorization: Bearer {{token}}
Content-Type: {{contentType}}

{
  "email": "outro.email@email.com",
  "password": "OutraSenha123"
}

### ===========================================
### VERIFICAÇÃO DE DISPONIBILIDADE (PÚBLICO)
### ===========================================
### Base: /api/users/availability
### Não requer autenticação

### Verificar disponibilidade de email
### GET /api/users/availability/email?value=email@teste.com
### Retorna: { available: boolean }
### Validação: deve ser um email válido
GET {{usersUrl}}/availability/email?value=email@teste.com

### Verificar disponibilidade de CPF
### GET /api/users/availability/cpf?value=12345678901
### Retorna: { available: boolean }
### Validação: deve ter exatamente 11 dígitos numéricos
GET {{usersUrl}}/availability/cpf?value=12345678901

### ===========================================
### EXEMPLOS DE ERROS
### ===========================================

### Erro 401: Requisição sem token de autenticação
GET {{userUrl}}

### Erro 400: Email inválido (formato incorreto)
PATCH {{userUrl}}/1
Authorization: Bearer {{token}}
Content-Type: {{contentType}}

{
  "email": "email-invalido"
}

### Erro 400: Senha muito curta (menos de 6 caracteres)
PATCH {{userUrl}}/1
Authorization: Bearer {{token}}
Content-Type: {{contentType}}

{
  "password": "123"
}

### Erro 400: CPF com formato inválido (não numérico)
GET {{usersUrl}}/availability/cpf?value=123.456.789-01

### Erro 400: CPF com quantidade incorreta de dígitos
GET {{usersUrl}}/availability/cpf?value=123456

### Erro 400: Email inválido na verificação de disponibilidade
GET {{usersUrl}}/availability/email?value=email-invalido
